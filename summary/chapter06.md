질문리스트 

#### 6. 레디스를 메시지 브로커로 사용하기

마이크로서비스에서는 비동기 통신이 권장되는 이유는 무엇인가? </br>
메시지 브로커는 OOO과 OOO으로 나눌 수 있는가?

##### 메시징 큐와 이벤트 스트림

- 생산자란(producer) vs 발행자란(publisher)
- 소비자란(consumer) vs 구독자란(subscriber)

메시징 큐와 이벤트 스트림의 2가지 차이점은? 
1. 방향성: 
2. 영속성:

메시징 큐와 이벤트 스트림은 각각 어느 상황에서 사용하는게 좋은가?

##### 레디스를 메시지 브로커로 사용하기

레디스에서 제공하는 pub/sub을 사용하면 빠르고 간단한 방식으로 메시지를 전달할 수 있는 메세지 브로커를 만들 수 있다. </br>
메시지 브로커는 특정 채널에 메시지를 전송하면 채널을 구독하고있는 모든 소비자에게 데이터를 바로 소비할 수 있다. </br>
- 메시지 브로커에 메세지는 채널 전체제 전파된 뒤에 메세지가 삭제되는가? 
- 완벽하게 메시지가 잘 전달되었는지 보장하는가?
- fire-and-forget 패턴은 무엇인가? 
  - 어떤 작업에서 사용사용하기에 적합한가?

메시지 큐 
- 어떤 자료구조를 사용하면 메시지 큐로 사용하기에 알맞는가?

스트림
- 어디서 영감받아서 만들어진 자료구조인가?
- append-only방식으로 동작하는데 append-only 방식은 무엇인가?
- stream에 저장되는 메시지를 실시간으로 리스닝하며 소비할 수 있는가?
- 저장되있는 데이터를 시간대별로 검색하며 조회할 수 있는가?

##### 레디스의 pub/sub

- 레디스 노드에 접근하는 클라이언트는 발행자 및 구독자가 될 수 있는가?
- 메세지를 읽는 구독자가 누구 인지 알 수 있는가?
- 한번 전파된 데이터는 레디스에 저장되지 않는가? 
- 정합성이 중요한 데이터를 레디스 pub/sub으로 메세지를 전송하는것이 좋은가? 이유는?

###### 메시지 publish하기

- `PUBLICSH channel message`명령어는 무엇인가?
- `subscribe envet1 event2`명령어는 무엇인가?
- 채널을 구독하기 시작하면 pub/sub 이외의 다른 명령어를 수행할 수 있는가?
- SUBSCRIBE, SSUBSCRIBE, SUNSUBSCRIBE, PSUBSCRIBE, UNSUBSCRIBE, PUNSUBSCRIBE, PING, RESET, QUIT 명령어는 무엇인가? 

###### 클러스터 구조에서의 pub/sub

- 클러스터란 무엇인가? 
- 클러스터는 왜 사용하는가? 
- 메세지를 발행하면 모든 클러스터에 메세지가 전달되는가?
- 클러스터의 pub/sub을 사용하면 클러스터의 핵심 목표와 부합하지 않는가? 왜그런가? 

###### sharded pub/sub

- sharded pub/sub은 왜 만들어졌는가?
- 메세지를 발행하면 모든 클러스터에 메세지가 전달되는가?
- sharded pub/sub의 장점은 무엇인가?
- SPUBLISH, SSUBSCRIBE는 무슨 명령어인가요? 

###### 레디스의 List를 메시징 큐로 사용하기

- 레디스의 list는 큐로 사용하기에 적절한 구조인가?
- list에는 tail과 head에서 데이터를 넣고 뺼 수 있는 LPUSH, LPOP, RPUSH, RPOP 명령어가 있는가?

##### list의 EX기능

```
요구사항
1. A user가 게시물을 올리면 B user의 타임라인에 게시물을 확인할 수 있어야한다.
```
- RPUSHX 명령어는 무엇인가?
- RPUSHX 명령어를 통해서 B user 타임라인 리스트에 타임라인캐시를 추가하는 이유는 무엇인가? 

##### list의 블로킹 기능

- 레디스를 이벤트 큐로 사용할 수 있는가?
- 폴링이란 무엇인가? 
  - 폴링의 단점?
- BRPOP, BLPOP, RPOP, LPOP은 무엇이 다른가?
- BLPOP은 어떻게 동작하는가? 데이터 있을때? 데이터 없을때?
- BRPOP, RPOP은 무엇과 무엇을 반환하는가?
  - 왜그런가?

##### list를 이용한 원형큐

- 언제 사용하는가? 2가지

##### Stream

- 언제 추가된 자료 구조인가? 
- 왜 사용하는가?
- 활용 사례 2가지

##### 스트림
- 컴퓨터 과학에서 말하는 스트림이란?
- 서버끼리의 통신 과정도 스트림이 될 수 있는가?
- 서버끼리 통신 과정을 이벤트를 발행해서 여러 서비스끼리 처리하게 할 수 있는가?


|                                                  카프카                                                  |                                                                                               레디스 스트림                                                                                               |
|:-----------------------------------------------------------------------------------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|                                                데이터 저장                                                 |                                                                                               데이터 저장                                                                                                | 
|                            - 토픽이란? </br> - 메세지는 유니크한 식별자를 갖는가? 멀티 파티션에서도?                             |                                                        - 스트림이란? </br> - 각 메세지는 유니크한 식별자를 갖는가? </br> - ID는 어떤 형식으로 나누어지는가? </br> <???>-<???>                                                         | 
|                                     생산자에서 소비자까지 메세지 이동 과정을 설명하시오                                      | - 명령어를 통해서 스트림을 따로 생성해야하는가? </br> - XADD 명령어는 무엇인가? </br> - XADD Email * subject "first" body "hello" 명령어는 어떻게 해석할 수 있는가? </br> - 메세지키를 직접 생성할 수 있는가? </br> - 0-1이 최소값이고 다음에 값을 넣을땐 이 값보다 작을 수 있는가? |
|                                                데이터 조회                                                 |                                                                                               데이터 조회                                                                                                |
|                                      - 카프카는 데이터를 실시간으로 리스닝 하는가?                                       |                                        - 레디스는 메세지를 실시간으로 리스닝 할 수 있는가? </br> - ID를 통해서 필요한 데이터를 검색할 수 있는가? </br> - XREAD 명령어는 무엇인가? </br> - XRANGE 명령어는 무엇인가?                                        |
|                                              소비자와 소비자 그룹                                              |                                                                                             소비자와 소비자 그룹                                                                                             | 
|                                       - 팬아웃이란? - 어떻게 팬아웃할 수있는가?                                       |                                                                      - XGROUB 명령어는 무엇인가? </br> - XREADGROUPB 명령어는 무엇인가? </br>                                                                       |
| - 소비자 그룹이란? </br> - 단일 파티션에서 순서 보장이 되는가? 왜? </br> - 멀티파이션에서 순서 보장이 되는가? 왜? 순서 보장하려면 어떻게 해야하는가? </br>  |                                            - 하나의 Stream에 여러 소비자 그룹을 둘 수 있는가? </br> - 한 Stream에 'a' 값을 넣으면 소비자1, 소비자2 에서 각각 'a' 값을 동일하게 읽을 수 있는가?  </br>                                             |

##### ACK와 보류리스트 

- last_delivered_id는 무엇인가? 
- 레디스 스트림은 소비자별로 보류 리스트(pending list)를 만드는가?

그림 6-26

- 보류 리스트와 ACK 메시지의 관계를 설명하여라

- stream의 ack의 at_most_once, at_least_once, exactly_once 방식은 무엇인가?
- XPENDING 명령어는 무엇인가?
- XCLAIM 명령어는 무엇인가?
- XAUTOCLAIM 명령어는 무엇인가?
- 메세지의 counter를 기록하는데 counter인가? 
- dead letter는 무엇인가? 

- 카프카는 cummer_offsets 을 기록하는 이것은 무엇을 뜻하는가?
